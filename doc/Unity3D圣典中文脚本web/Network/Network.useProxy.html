<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; " />
<title>Network.useProxy 使用代理</title>
<meta name="Keywords" content="unity,Network,useProxy,使用代理" />
<meta name="Description" content="表示是否需要代理支持，在这种情况下，流量通过代理服务器传递。" />
<link href="../Style/CSS/UnityStyle.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Style/SJ/jquery.min.js"></script>
<script type="text/javascript" src="../Style/SJ/tabs.min.js"></script>
  <script type="text/javascript">
$(function() {
	$("ul.tabs").tabs("> .panes", {initialIndex: 1});
});
</script>

</head>

<body>
<div class="head">
<div class="logo"><a href="/Script"><img src="../Style/Images/unitylogo.png" alt="Unity圣典" width="350" height="80"  title="Unity圣典"/></a></div>
<div class="menu"><a href="/">首页</a><a href="/Script">Unity脚本</a></div>
</div>

<div class="mainbody">
<div class="leftmain">
    	        <ul class="scriptmenu">
          <li><a href="../index.html">Overview</a> <span class="trans">概述</span></li>
            <li><a href="../Runtime.Classes.html">Runtime Classes</a> <span class="trans">实时运行类</span></li>
            <ul>
                <li><a href="../Attributes/Attributes.html">Attributes</a> <span class="trans">属性</span></li>
                <li><a href="../Enumerations/Enumerations.html">Enumerations</a> <span class="trans">枚举</span></li>
            </ul>
            <li><a href="../Editor.Classes.html">Editor Classes</a> <span class="trans">编辑器类</span></li>
            <ul>
                <li><a href="../Editor_Enumerations/Editor.Enumerations.html">Enumerations</a> <span class="trans">枚举</span></li>
            </ul>
            <li>History <span class="trans">历史</span></li>
            <li><a href="../index.Classes.html">Index</a> <span class="trans">总索引</span></li>
        </ul>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-8054246454688368";
/* Unity方 */
google_ad_slot = "5047319569";
google_ad_width = 200;
google_ad_height = 200;
//-->
</script>
<script type="text/javascript"
src="">
</script>
        <div class="subclass"><a href="Network.html">Network</a><span class="transer">翻译：U_鹰 </span>
                <ul>
                    <li><a href="Network.AllocateViewID.html">AllocateViewID</a></li>
                    <li><a href="Network.CloseConnection.html">CloseConnection</a></li>
                    <li><a href="Network.connections.html">connections</a></li>
                    <li><a href="Network.connectionTesterIP.html">connectionTesterIP</a></li>
                    <li><a href="Network.connectionTesterPort.html">connectionTesterPort</a></li>
                    <li><a href="Network.Connect.html">Connect</a></li>
                    <li><a href="Network.DestroyPlayerObjects.html">DestroyPlayerObjects</a></li>
                    <li><a href="Network.Destroy.html">Destroy</a></li>
                    <li><a href="Network.Disconnect.html">Disconnect</a></li>
                    <li><a href="Network.GetAveragePing.html">GetAveragePing</a></li>
                    <li><a href="Network.GetLastPing.html">GetLastPing</a></li>
                    <li><a href="Network.HavePublicAddress.html">HavePublicAddress</a></li>
                    <li><a href="Network.incomingPassword.html">incomingPassword</a></li>
                    <li><a href="Network.InitializeSecurity.html">InitializeSecurity</a></li>
                    <li><a href="Network.InitializeServer.html">InitializeServer</a></li>
                    <li><a href="Network.Instantiate.html">Instantiate</a></li>
                    <li><a href="Network.isClient.html">isClient</a></li>
                    <li><a href="Network.isMessageQueueRunning.html">isMessageQueueRunning</a></li>
                    <li><a href="Network.isServer.html">isServer</a></li>
                    <li><a href="Network.logLevel.html">logLevel</a></li>
                    <li><a href="Network.maxConnections.html">maxConnections</a></li>
                    <li><a href="Network.minimumAllocatableViewIDs.html">minimumAllocatableViewIDs</a></li>
                    <li><a href="Network.natFacilitatorIP.html">natFacilitatorIP</a></li>
                    <li><a href="Network.natFacilitatorPort.html">natFacilitatorPort</a></li>
                    <li><a href="Network.OnConnectedToServer.html">OnConnectedToServer</a></li>
                    <li><a href="Network.OnDisconnectedFromServer.html">OnDisconnectedFromServer</a></li>
                    <li><a href="Network.OnFailedToConnectToMasterServer.html" title="OnFailedToConnectToMasterServer">OnFailedToConnectToM...</a></li>
                    <li><a href="Network.OnFailedToConnect.html">OnFailedToConnect</a></li>
                    <li><a href="Network.OnNetworkInstantiate.html">OnNetworkInstantiate</a></li>
                    <li><a href="Network.OnPlayerConnected.html">OnPlayerConnected</a></li>
                    <li><a href="Network.OnPlayerDisconnected.html">OnPlayerDisconnected</a></li>
                    <li><a href="Network.OnSerializeNetworkView.html">OnSerializeNetworkView</a></li>
                    <li><a href="Network.OnServerInitialized.html">OnServerInitialized</a></li>
                    <li><a href="Network.peerType.html">peerType</a></li>
                    <li><a href="Network.player.html">player</a></li>
                    <li><a href="Network.proxyIP.html">proxyIP</a></li>
                    <li><a href="Network.proxyPassword.html">proxyPassword</a></li>
                    <li><a href="Network.proxyPort.html">proxyPort</a></li>
                    <li><a href="Network.RemoveRPCsInGroup.html">RemoveRPCsInGroup</a></li>
                    <li><a href="Network.RemoveRPCs.html">RemoveRPCs</a></li>
                    <li><a href="Network.sendRate.html">sendRate</a></li>
                    <li><a href="Network.SetLevelPrefix.html">SetLevelPrefix</a></li>
                    <li><a href="Network.SetReceivingEnabled.html">SetReceivingEnabled</a></li>
                    <li><a href="Network.SetSendingEnabled.html">SetSendingEnabled</a></li>
                    <li><a href="Network.TestConnectionNAT.html">TestConnectionNAT</a></li>
                    <li><a href="Network.TestConnection.html">TestConnection</a></li>
                    <li><a href="Network.time.html">time</a></li>
                    <li><a href="Network.useProxy.html">useProxy</a></li>
                </ul>
</div>
    </div>
    <div class="rightmain"><!--right start--><script type="text/javascript"><!--
google_ad_client = "ca-pub-8054246454688368";
/* Unity横 */
google_ad_slot = "2374072180";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="">
</script>
<h1><a href="Network.html">Network</a>.useProxy 使用代理</h1>
<p class="h1inherit"></p>
<p>static var <em>useProxy</em> : bool </p>
<p><em>Description</em><span class="trans">描述</span></p>
<p> Indicate if proxy support is needed, in which case traffic is relayed through the proxy server.</p>
<p>表示是否需要代理支持，在这种情况下，流量通过代理服务器传递。</p>
<p> The proxy server is a solution to connectivity problems with servers  as well as clients. When a machine has an non NAT punchthrough capable  router his connectivity options are limited. A game cannot be hosted  as nobody external can connect to him (only clients on the local network can).  By using the proxy server the machine can be fully connectable but with  the extra cost of having all traffic relayed through another server.  A non NAT punchthrough capable client can connect to any server through   the proxy server, as long as the proxy server is set up properly. </p>
<p>代理服务器是一种与服务器和客户端连接问题的解决方案。当机器有一个非NAT穿透能力的路由器，其连接的选择非常优先。一个游戏不能没有外部连接（只可以客户端在本地网络）。通过使用代理服务器，该机器可以具有完全的连接性，但是额外的成本是所有的流量都会通过另一台服务器传递。一个没有NAT穿透能力的客户端通过代理能够连接到任何服务器，只要在代理服务器设置正确。</p>
<p> Unity Technologies does not provide a proxy server for public use, so to  use this feature you will need to set up your own proxy server. Of course  it is advisable to set up a proxy server with a public IP address and  a lot of available bandwidth. </p>
<p>Unity并不提供代理服务器为公众使用。所以你需要自己建立代理服务器。当然，用公有IP地址设置代理服务器并保证有大量可用带宽是明智的。</p>
<p> When running as a client, just enabling <a href="Network.useProxy.html">Network.useProxy</a> is all you have  to do. Connect to the server as usual with <a href="Network.Connect.html">Network.Connect</a>(). All traffic   will be relayed through the proxy server. The servers external IP and internal  IP still work as usual. So clients can connect to him directly without  the proxy in case they are located on the same network. </p>
<p>当作为客户端运行时，只要启用<a href="Network.useProxy.html">Network.useProxy</a>就可以。像通常使用 <a href="Network.Connect.html">Network.Connect</a>()连接到服务器。所有浏览通过代理服务器传递。服务器的外部IP和内部IP还像往常一样工作。这样如果它们位于同一网络中，客户端可以直接连接而不经过代理。</p>
<p> When running as a server OnServerInitialized(NetworkPlayer) returns a  NetworkPlayer structure which indicates what the game servers relayed  IP/port is, i.e. what port the proxy server allocated to the game server.   This is the IP/port others can use to connect to. When connecting to the  server, the clients don't treat the server any differently than other servers.  Technically speaking, they don't need to know at all that the game server  is getting help from a proxy server. </p>
<p>作为一个服务器运行时，OnServerInitialized(NetworkPlayer)返回一个NetworkPlayer结构，表示游戏服务器中继的IP/端口，即，代理服务器分配给游戏服务器的端口是什么。这个是其他客户端可以连接的IP/端口。当连接到服务器时，客户端不会将这个服务器与其他服务器区别对待。严格的说，它们不需要知道这个服务器得到代理服务器的帮助。</p>
<p> When using the master server you can no longer only rely on the IP/port he  registers for servers when using proxy support. The proxy server IP address  and port which the server is using can be placed in the comment field of  the data sent to the master server. A client which received host information  from the master server can peek into the comment field and find out if  he can use an alternative IP/port for that host.</p>
<p>当使用主服务器时，使用代理支持，你不能只依赖于为服务器IP/端口注册。服务器使用的代理服务器的IP地址和端口，可以放置在数据域的注释中来发送给主服务器。从主服务器接收主机信息的客户端可以去除注释域并查看它是否能够为那个主机使用另一个可选的IP端口。 </p>
<p> IMPORTANT: You should never enable proxy support for both the server and  the client connecting to him. Unexpected things are bound to happen. </p>
<p>重要事项：你不应该同时为连接到它的服务器和客户端启用代理支持，会发生意想不到的事情。</p>
<div class="wrap">
	<ul class="tabs">
		<li><a href="#">C#</a></li>
		<li><a href="#">JavaScript</a></li>
	</ul>
    <div class="panes">
      <pre><code>using UnityEngine;
using System.Collections;

public class example : <a href="../MonoBehaviour/MonoBehaviour.html">MonoBehaviour</a> {
	public bool imaserver;
	public string serverIP;
	public int serverPort;
	public bool serverUsesNAT;
	void Awake() {
		<a href="Network.proxyIP.html">Network.proxyIP</a> = &quot;1.1.1.1&quot;;
		<a href="Network.proxyPort.html">Network.proxyPort</a> = 1111;
		if (imaserver)
			StartServerWithProxy();
		else
			ConnectToServerWithProxy();
	}
	void StartServerWithProxy() {
		<a href="Network.useProxy.html">Network.useProxy</a> = true;
		<a href="Network.InitializeServer.html">Network.InitializeServer</a>(2, 25000, false);
	}
	void OnServerInitialized(<a href="../NetworkPlayer/NetworkPlayer.html">NetworkPlayer</a> player) {
		if (Network.useProxy)
			<a href="../Debug/Debug.Log.html">Debug.Log</a>(&quot;Successfully started server with proxy support. We are connectable through &quot; + player.ipAddress + &quot;:&quot; + player.port);

	}
	void OnFailedToConnect(<a href="../Enumerations/NetworkConnectionError/NetworkConnectionError.html">NetworkConnectionError</a> msg) {
		if (<a href="Network.useProxy.html">Network.useProxy</a> &amp;&amp; imaserver)
			<a href="../Debug/Debug.LogError.html">Debug.LogError</a>(&quot;Failed to connect to proxy server: &quot; + msg);

	}
	void ConnectToServerWithProxy() {
		<a href="Network.useProxy.html">Network.useProxy</a> = true;
		<a href="Network.Connect.html">Network.Connect</a>(serverIP, serverPort);
	}
	void OnConnectedToServer() {
		<a href="../Debug/Debug.Log.html">Debug.Log</a>(&quot;Connected successfully to server&quot;);
	}
}</code></pre></div>
    <div class="panes">
      <pre><code>var imaserver: boolean;
var serverIP: <a href="../String/String.html">String</a>;
var serverPort: int;
var serverUsesNAT: boolean;

function Awake() {
	<span class="notes">// Set custom proxy server address
	//设置自定义代理服务器地址</span>
	<a href="Network.proxyIP.html">Network.proxyIP</a> = &quot;1.1.1.1&quot;;
	<a href="Network.proxyPort.html">Network.proxyPort</a> = 1111;

	if (imaserver)
		StartServerWithProxy();
	else
		ConnectToServerWithProxy();
}

function StartServerWithProxy() {
	<a href="Network.useProxy.html">Network.useProxy</a> = true;
	<a href="Network.InitializeServer.html">Network.InitializeServer</a>(2,25000, false);
}

function OnServerInitialized(player: <a href="../NetworkPlayer/NetworkPlayer.html">NetworkPlayer</a>) {
	if (<a href="Network.useProxy.html">Network.useProxy</a>)
		<a href="../Debug/Debug.Log.html">Debug.Log</a> (&quot;Successfully started server with proxy support. We are connectable through &quot;
			+ player.ipAddress + &quot;:&quot; + player.port);
}

function OnFailedToConnect(msg: <a href="../Enumerations/NetworkConnectionError/NetworkConnectionError.html">NetworkConnectionError</a>) {
	if (<a href="Network.useProxy.html">Network.useProxy</a> &amp;&amp; imaserver) {
		<a href="../Debug/Debug.LogError.html">Debug.LogError</a>(&quot;Failed to connect to proxy server: &quot; + msg);
	}
}

function ConnectToServerWithProxy() {
	<a href="Network.useProxy.html">Network.useProxy</a> = true;
	<a href="Network.Connect.html">Network.Connect</a>(serverIP, serverPort);
}

function OnConnectedToServer() {
	<a href="../Debug/Debug.Log.html">Debug.Log</a>(&quot;Connected successfully to server&quot;);
}</code></pre></div>
</div>
<div class="date"><span>最后修改：<!-- #BeginDate format:wfcCh2m -->2011年4月2日 Saturday  16:15<!-- #EndDate --></span></div><script type="text/javascript"><!--
google_ad_client = "ca-pub-8054246454688368";
/* Unity横 */
google_ad_slot = "2374072180";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="">
</script>
<!--right end--></div>
    <div class="clear"></div>
</div>

<div style="padding: 30px; text-align: center; clear:both"><p>本脚本参考基于Unity 3.30f4</p>英文部分版权属&copy;<a href="http://unity3d.com/">Unity</a>公司所有，中文部分&copy;
<a href="http://3d.ceeger.com/">Unity圣典</a> 版权所有，未经许可，严禁转载 。</div>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fce93455bb2ae8f76d8b4a8d07db27a24' type='text/javascript'%3E%3C/script%3E"));
</script>

</body>
</html>
